---
title: "[Python] LLM 스트리밍 응답이 뚝뚝 끊긴다면? 표준출력과 버퍼, print flush 이해하기" # 제목 (필수)
excerpt: "표준출력의 버퍼와 출력 조건에 대해 이해하기" # 서브 타이틀이자 meta description (필수)
date: 2026-01-29 22:13:00 +0900      # 작성일 (필수)
lastmod: 2026-01-29 22:13:00 +0900   # 최종 수정일 (필수)
last_modified_at: 2026-01-29 22:13:00 +0900   # 최종 수정일 (필수)
categories: Python        # 다수 카테고리에 포함 가능 (필수)
tags: python 파이썬 표준출력 버퍼 버퍼링 stdout print flush buffer buffering stream 문단                     # 태그 복수개 가능 (필수)
classes: wide        # wide : 넓은 레이아웃 / 빈칸 : 기본 //// wide 시에는 sticky toc 불가
toc: true        # 목차 표시 여부
toc_label:       # toc 제목
toc_sticky: true # 이동하는 목차 표시 여부 (toc:true 필요) // wide 시에는 sticky toc 불가
header: 
  image:         # 헤더 이미지 (asset내 혹은 url)
  teaser:        # 티저 이미지??
  overlay_image: /assets/images/banners/banner.gif            # 헤더 이미지 (제목과 겹치게)
  # overlay_color: '#333'            # 헤더 배경색 (제목과 겹치게) #333 : 짙은 회색 (필수)
  video:
    id:                      # 영상 ID (URL 뒷부분)
    provider:                # youtube, vimeo 등
sitemap :                    # 구글 크롤링
  changefreq : daily         # 구글 크롤링
  priority : 1.0             # 구글 크롤링
author: # 주인 외 작성자 표기 필요시
permalink: 
sidebar:
  nav: docs_python
pinned: 
---
<!--postNo: 20260129_003-->


## Intro  

![](/assets/images/20260129_003_001.gif)  

OpenAI API를 이용해 답변을 실시간 스트리밍(stream)으로 받아오는 AI 에이전트를 개발하던 중이었다. ChatGPT처럼 한 토큰씩 타이핑치듯이 출력되는 화면을 기대했지만, 예상과 달리 응답이 **한 문단씩 뭉텅이로 끊겨서 출력되는 현상**을 발견했다.  

### 문제 원인 : 표준 출력의 버퍼링  

문제의 원인은 바로 **표준 출력(stdout) 의 버퍼링(buffering)**이었다. 파이썬의 `print()` 함수는 호출될 때마다 즉시 화면에 글자를 뿌리는 것이 아니다. 내부적으로 **출력 버퍼**라는 임시 공간에 내용을 먼저 쌓아두었다가, 특정 조건이 만족될 때 OS의 표준 출력으로 데이터를 내보내게 된다.  

[버퍼에 대해서 궁금하다면 - 버퍼의 개념과 다양한 버퍼 방식](https://whdrns2013.github.io/operation_system/20250903_002_buffer/)

대표적인 버퍼 방출(flush) 조건들은 다음과 같다.  

1. 출력 버퍼가 정해진 용량만큼 가득 찼을 때  
2. 줄바꿈(`\n`)이 발생했을 때  
3. 프로그램이 정상적으로 종료될 때  
4. 강제로 버퍼를 비우도록 명령할 때 (flush)  

### 왜 평소에는 몰랐을까?  

- 바로 `print(end="")` 조건 때문  

평소에 반복문에서 `print()`를 사용할 때에는 실시간으로 한 줄씩 잘 출력된다. 그 이유는 `print()`함수의 `end` 옵션의 기본값이 바로 줄바꿈 문자(`\n`)이기 때문이다. 앞선 단락에서 소개했든 줄바꿈이 발생할 때에는 버퍼가 비워지고 출력이 발생하게 된다. 때문에 평소에 이런 현상을 접하지 못한 것이었다.  

하지만 LLM 스트리밍에서는 토큰을 공백 없이 이어붙이기 위해 `print(..., end="")`형식을 사용했다. 이 경우에는 줄바꿈이 일어나지 않으므로, 데이터는 계속 출력 버퍼에 쌓이다가, **버퍼 용량이 가득 차는 시점**에 한꺼번에 표준 출력에 전달되는 것이다. 이게 바로 문단 단위 출력의 원인이었다.  

이를 좀 더 쉽게 체감할 수 있게 예시 코드를 준비해보았다. 실행해보도록 하자.  

<br>

- 줄바꿈을 하는 경우  

```python
# 줄바꿈을 하는 경우 -> 바로 출력됨
import time
gen = (x for x in range(1000))

for it in gen:
    print(it)
    time.sleep(0.02)
```

<br>

- 줄바꿈을 하지 않는 경우  

```python
# 줄바꿈을 하지 않는 경우 -> 버퍼가 차는 것을 기다렸다가 출력됨
import time
gen = (x for x in range(1000))

for it in gen:
    print(it, end="")
    time.sleep(0.02)
```


### 해결  

- 버퍼를 즉시 비우는 `flush=True` 옵션을 적용  

파이썬의 print 함수에서는 출력 버퍼를 즉시 비우는 `flush` 라는 옵션이 있다. 이 옵션은, print 내용을 바로 OS로 전달해 출력되도록 하는 역할을 한다. 이를 적용해서 LLM 의 stream 을 정상적으로 구현할 수 있었다.  

```python
# 예시 코드
for chunk in response:
    print(chunk, end="", flush=True)
...
```

![](/assets/images/20260129_003_002.gif)  

## Reference  

[https://docs.python.org/ko/3.13/library/functions.html#print](https://docs.python.org/ko/3.13/library/functions.html#print)  